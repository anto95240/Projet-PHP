// Déclarez et initialisez le tableau pour stocker les produits
let products = [];

document.addEventListener('DOMContentLoaded', function() {
    // Vérifier si nous sommes sur la page admin.php
    const isAdminPage = window.location.pathname.includes('admin.php');

    // Récupérer les produits depuis le stockage local
    const savedProducts = localStorage.getItem('products');
    
    if (savedProducts) {
        try {
            products = JSON.parse(savedProducts);
        } catch (error) {
            console.error('Erreur lors de la récupération des produits depuis le stockage local :', error);
        }
    }

    const productList = document.getElementById('productList');

    // Afficher les produits récupérés
    renderProducts();

    // Ajoutez un écouteur d'événements pour le clic sur le bouton "Ajouter"
    document.getElementById('btnAjouter').addEventListener('click', function() {
        // Récupère les valeurs des champs de formulaire
        const productName = document.getElementById('productName').value;
        const productCat = document.getElementById('productCat').value;
        const productPrice = document.getElementById('productPrice').value;
        const productDescription = document.getElementById('productDescription').value;
        const productQuantity = document.getElementById('productQuantity').value;

        // Ajoutez le nouveau produit au tableau
        addProduct(productName, productCat, productPrice, productDescription, productQuantity);

        // Mettez à jour l'affichage des produits sur la page
        renderProducts();
    });

    // Ajoutez un écouteur d'événements pour le clic sur le bouton "Modifier"
    document.getElementById('btnModifier').addEventListener('click', function() {
        // Votre logique de modification de produit ici...
    });

    // Ajoutez un écouteur d'événements pour le clic sur le bouton "Supprimer tout"
    document.getElementById('btnSupprimerTout').addEventListener('click', function() {
        // Votre logique de suppression de tous les produits ici...
    });

    // Fonction pour afficher les produits
    function renderProducts() {
        // Videz la liste des produits affichée sur la page
        productList.innerHTML = '';

        // Parcourez tous les produits dans le tableau et ajoutez-les à la liste des produits sur la page
        products.forEach(product => {
            let productCard = `
                <div class="col-md-2 my-1">
                    <div class="card" style="width: 16rem !important;">
                        <div class="card-body">
                            <h5 class="card-title">${product.name}</h5>
                            <p class="card-text">${product.category}</p>
                            <p class="card-text">${product.price}</p>
                            <a href="/src/produit/produit.php?product=${product.id}&image=image${product.id}.jpg" class="btn btn-primary">Voir plus</a>`;

            // Ajouter la checkbox et le bouton "Supprimer" si nous sommes sur la page admin.php
            if (isAdminPage) {
                productCard += `
                            <button class="btn btn-danger delete-product">Supprimer</button>`;
            }

            productCard += `
                        </div>
                    </div>
                </div>`;

            // Ajoutez la carte du produit à la liste des produits sur la page
            productList.innerHTML += productCard;
        });
    }

    // Fonction pour ajouter un produit dans le tableau et le stockage local
    function addProduct(name, category, price, description, quantity) {
        // Ajoutez le nouveau produit au tableau
        products.push({
            id: products.length + 1, // Utilisez la longueur du tableau plus un comme identifiant unique
            name: name,
            category: category,
            price: price,
            description: description,
            quantity: quantity
        });

        // Enregistrez les produits mis à jour dans le stockage local
        localStorage.setItem('products', JSON.stringify(products));
    }

    // Ajoutez d'autres fonctionnalités ici...

});
